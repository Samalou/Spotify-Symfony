{% extends 'base.html.twig' %}

{% block stylesheets %}
    <style>
        .track-info {
            display: flex;
            flex-direction: row;
            align-items: flex-start;
            color: white;
        }
        #track-picture {
            width: 80vh;
            height: 80vh;
            border-radius: 10px;
            margin-right: 30px;
        }
        .track-details {
            flex: 1;
        }
        .track-details h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        .track-details p {
            font-size: 18px;
            margin-bottom: 10px;
        }
        .track-details a {
            color: #1DB954;
            font-size: 18px;
            text-decoration: underline;
            padding : 0;
        }
        .track-details .preview {
            margin-top: 20px;
        }
        .track-details .explicit {
            color: red;
            font-weight: bold;
        }
        .track-details .duration, .track-details .popularity, .track-details .isrc {
            color: #888;
        }
        .track-details .spotify-link {
            margin-top: 10px;
        }
        .track-details .local-track {
            font-style: italic;
            color: #888;
        }
        #recommendations {
            margin-top: 30px;
        }
        .recommendation-card {
            flex-basis: 15%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-direction: column;
            background-color: #131313;
            border: 1px solid white;
            border-radius: 10px;
            margin: 10px;
            padding: 5px;
            width: 200px;
            color: white;
        }

        .recommendation-card h3{
            font-size: 18px;
        }

        .recommendation-card a{
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .recommendation-card img {
            width: 100%;
            height: auto;
            border-radius: 10px;
        }
        #recommendations_container {
            display: flex;
            flex-wrap: wrap;
        }
        #recommendations{
            color: white;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="track-info">
        {% if track.getPictureLink() %}
            <img src="{{ track.getPictureLink() }}" alt="Image de l'album" id="track-picture">
        {% else %}
            <img src="/img/placeholder.png" alt="Pas d'image disponible" id="track-picture">
        {% endif %}

        <div class="track-details">
            <h1>{{ track.getName() }}</h1>

            {% if track.isExplicit() %}
                <p class="explicit">Explicit</p>
            {% endif %}

            <p class="popularity">Popularité : {{ track.getPopularity() }}%</p>
            <p>Type : {{ track.getType() }}</p>
            <p>Numéro de disque : {{ track.getDiscNumber() }}</p>
            <p class="duration">Durée : {{ (track.getDurationMs() / 1000) // 60 }} min {{ (track.getDurationMs() / 1000) % 60 }} sec</p>

            <p class="spotify-link">
                <a href="{{ track.getSpotifyUrl() }}" target="_blank">Écouter sur Spotify</a>
            </p>

            {% if track.isLocal() %}
                <p class="local-track">Cette piste est locale</p>
            {% endif %}

            <p class="preview">Écouter un extrait :</p>
            {% if track.getPreviewUrl() %}
                <div class="audio-player">
                    <audio controls>
                        <source src="{{ track.getPreviewUrl() }}" type="audio/mpeg">
                        Votre navigateur ne supporte pas l'élément audio.
                    </audio>
                </div>
            {% endif %}
        </div>
    </div>

    <div id="recommendations">
        <h2 id="recommendations">Recommandations :</h2>
        <div id="recommendations_container">
            {% for recommendedTrack in recommendations %}
                <div class="recommendation-card">
                    <a href="{{ path('app_track_information', {'id' : recommendedTrack.getSpotifyId()}) }}">
                        {% if recommendedTrack.getPictureLink() %}
                            <img src="{{ recommendedTrack.getPictureLink() }}" alt="Image de l'album">
                        {% else %}
                            <img src="/img/placeholder.png" alt="Pas d'image disponible">
                        {% endif %}
                    </a>
                    <h3>{{ recommendedTrack.getName() }}</h3>
                </div>
            {% else %}
                <p>Aucune recommandation trouvée.</p>
            {% endfor %}
        </div>
    </div>
{% endblock %}
